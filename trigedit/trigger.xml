<GuiXml>
   <Controls>
      <Control name="ItemTrig_TrigEdit_Template_OpcodeList" virtual="true">
         <Controls>
            <Control name="$(parent)Buttons">
               <Anchor point="TOPRIGHT" />
               <Anchor point="BOTTOMRIGHT" />
               <Dimensions x="150" />
               <Controls>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)Add"  text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_ADD">
                     <Anchor point="LEFT" />
                     <Anchor point="TOPRIGHT" />
                  </Button>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)Edit" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_EDIT">
                     <Anchor point="LEFT" />
                     <Anchor point="TOPRIGHT" offsetY="8" relativePoint="BOTTOMRIGHT" relativeTo="$(parent)Add" />
                  </Button>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)MoveUp" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_MOVEUP">
                     <Anchor point="LEFT" />
                     <Anchor point="TOPRIGHT" offsetY="8" relativePoint="BOTTOMRIGHT" relativeTo="$(parent)Edit" />
                  </Button>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)MoveDown" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_MOVEDOWN">
                     <Anchor point="LEFT" />
                     <Anchor point="TOPRIGHT" offsetY="8" relativePoint="BOTTOMRIGHT" relativeTo="$(parent)MoveUp" />
                  </Button>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)Delete" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_DELETE">
                     <Anchor point="LEFT" />
                     <Anchor point="TOPRIGHT" offsetY="8" relativePoint="BOTTOMRIGHT" relativeTo="$(parent)MoveDown" />
                  </Button>
               </Controls>
            </Control>
            <Control name="$(parent)List" inherits="ItemTrig_UITemplate_ThemedScrollSelectList">
               <Anchor point="TOPLEFT" />
               <Anchor point="BOTTOMRIGHT" relativeTo="$(parent)Buttons" relativePoint="BOTTOMLEFT" offsetX="-5" />
            </Control>
         </Controls>
      </Control>
      <Control name="ItemTrig_TrigEdit_Template_Opcode" virtual="true"
         mouseEnabled="true"
         inherits="ItemTrig_UITemplate_WScrollSelectListItem"
      >
         <OnInitialized> ItemTrig.UI.OpcodeListEntry:install(self) </OnInitialized>
         <Controls>
            <Texture name="$(parent)Bg" color="282828" excludeFromResizeToFitExtents="true">
               <AnchorFill />
            </Texture>
            <Label name="$(parent)Text" font="ITEMTRIG_FONT_LIST_ITEM" text="Opcode text" color="INTERFACE_COLOR_TYPE_TEXT_COLORS:INTERFACE_TEXT_COLOR_NORMAL">
               <Anchor point="TOPLEFT" offsetX="3" offsetY="3" />
            </Label>
         </Controls>
      </Control>
      <TopLevelControl name="ItemTrig_TriggerEdit"
         mouseEnabled="true"
         movable="true"
         clampedToScreen="true"
         hidden="true"
         inherits="ItemTrig_UITemplate_WWindow"
      >
         <!-- <Dimensions x="800" y="600" /> -->
         <Dimensions x="1000" y="800" /> <!-- dimensions for large fonts -->
         <DimensionConstraints minX="600" minY="600" />
         <Anchor point="CENTER" />
         <OnInitialized> ItemTrig:setupWindow("triggerEdit", self) </OnInitialized>
         <Controls>
            <Control name="$(parent)Bottom">
               <Anchor point="BOTTOMLEFT"  offsetY="-5" />
               <Anchor point="BOTTOMRIGHT" offsetY="-5" />
               <Dimensions y="50" />
               <Controls>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)OK" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_SAVE">
                     <Anchor point="BOTTOMRIGHT" />
                     <OnClicked> ItemTrig.windows.triggerEdit:commit() </OnClicked>
                  </Button>
                  <Button inherits="ItemTrig_UITemplate_ThemedButton" name="$(parent)Cancel" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_BUTTON_CANCEL">
                     <Anchor point="BOTTOMRIGHT" relativeTo="$(parent)OK" relativePoint="BOTTOMLEFT" offsetX="-8" />
                     <OnClicked> ItemTrig.windows.triggerEdit:cancel() </OnClicked>
                  </Button>
               </Controls>
            </Control>
            <Control name="$(parent)NameBar">
               <Anchor point="TOPLEFT"  offsetY="5" relativeTo="$(parent)TitleBar" relativePoint="BOTTOMLEFT" />
               <Anchor point="TOPRIGHT" offsetY="5" relativeTo="$(parent)TitleBar" relativePoint="BOTTOMRIGHT" />
               <Dimensions y="50" />
               <OnInitialized>
                  local text = GetControl(self, "Label")
                  local edit = GetControl(self, "Value")
                  local h1 = text:GetHeight()
                  local h2 = edit:GetHeight()
                  if h1 > h2 then
                     self:SetHeight(h1)
                  else
                     self:SetHeight(h2)
                  end
               </OnInitialized>
               <Controls>
                  <Label name="$(parent)Label" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_LABEL_TRIGGER_NAME" font="ZoFontChat">
                     <Anchor point="TOPLEFT" />
                  </Label>
                  <EditBox name="$(parent)Value"
                     multiLine="false"
                     newLineEnabled="false"
                     inherits="ZO_DefaultEdit"
                  >
                     <Anchor point="TOPLEFT" relativeTo="$(parent)Label" relativePoint="TOPRIGHT" offsetX="8" />
                     <Anchor point="TOPRIGHT" offsetX="-5" />
                     <OnTextChanged> ItemTrig.windows.triggerEdit:onNameChanged() </OnTextChanged>
                     <Controls>
                        <Backdrop name="$(parent)Bg" inherits="ZO_EditBackdrop">
                           <AnchorFill/>
                        </Backdrop>
                     </Controls>
                  </EditBox>
               </Controls>
            </Control>
            <Control name="$(parent)Col1">
               <Anchor point="TOPLEFT"     offsetY="5" relativeTo="$(parent)NameBar" relativePoint="BOTTOMLEFT" />
               <Anchor point="BOTTOMRIGHT" offsetY="-5" relativeTo="$(parent)Bottom" relativePoint="TOPRIGHT" />
               <Dimensions x="200" />
               <OnInitialized>
                  --
                  -- This is ugly, but I can't seem to get this kind of sizing working just using 
                  -- the anchor system: I want the two opcode lists in this column to flex, each 
                  -- consuming half of the space not consumed by the text headers.
                  --
                  local cHead    = self:GetNamedChild("ConditionsHeader")
                  local cList    = self:GetNamedChild("Conditions")
                  local aHead    = self:GetNamedChild("ActionsHeader")
                  local aList    = self:GetNamedChild("Actions")
                  local this     = self
                  local resizing = true
                  local function onResizeStart(control)
                     resizing = true
                  end
                  local function onResizeFrame(control)
                     if not resizing then
                        return
                     end
                     local span = control:GetHeight()
                     span = span - cHead:GetHeight()
                     span = span - aHead:GetHeight()
                     span = span - 8
                     cList:SetHeight(span / 2)
                     aList:SetHeight(span / 2)
                  end
                  local function onResizeStop(control)
                     resizing = false
                  end
                  ZO_PreHookHandler(self:GetOwningWindow(), "OnResizeStart", onResizeStart)
                  ZO_PreHookHandler(self, "OnUpdate", onResizeFrame)
                  resizing = true
                  onResizeFrame(self)
                  resizing = false
               </OnInitialized>
               <Controls>
                  <Label name="$(parent)ConditionsHeader" font="ZoFontWinT2" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_LABEL_CONDITIONS">
                     <Anchor point="TOPLEFT" />
                     <Anchor point="TOPRIGHT" />
                  </Label>
                  <Control name="$(parent)Conditions" inherits="ItemTrig_TrigEdit_Template_OpcodeList">
                     <Anchor point="TOPLEFT"  relativeTo="$(parent)ConditionsHeader" relativePoint="BOTTOMLEFT" />
                     <Anchor point="TOPRIGHT" relativeTo="$(parent)ConditionsHeader" relativePoint="BOTTOMRIGHT" />
                  </Control>
                  <Label name="$(parent)ActionsHeader" font="ZoFontWinT2" text="ITEMTRIG_STRING_UI_TRIGGEREDIT_LABEL_ACTIONS">
                     <Anchor point="TOPLEFT"  relativeTo="$(parent)Conditions" relativePoint="BOTTOMLEFT" />
                     <Anchor point="TOPRIGHT" relativeTo="$(parent)Conditions" relativePoint="BOTTOMRIGHT" />
                  </Label>
                  <Control name="$(parent)Actions" inherits="ItemTrig_TrigEdit_Template_OpcodeList">
                     <Anchor point="TOPLEFT"     relativeTo="$(parent)ActionsHeader" relativePoint="BOTTOMLEFT" />
                     <Anchor point="BOTTOMRIGHT" relativeTo="$(grandparent)Bottom"   relativePoint="TOPRIGHT" offsetY="-8" />
                  </Control>
               </Controls>
            </Control>
         </Controls>
      </TopLevelControl>
   </Controls>
</GuiXml>